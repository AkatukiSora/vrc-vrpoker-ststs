# 4. Memory/SQLite二重リポジトリパターン

Date: 2026-02-27
日付: 2026-02-27

## Status

accepted

## 背景

統計のリアルタイム更新と永続化の両方が必要で、UI からは同一のリポジトリ API で扱いたい。
テスト時には軽量で高速な実装が求められる。

## 決定

`internal/persistence` にリポジトリインターフェースを定義し、
`memory_repository` と `sqlite_repository` の 2 実装を用意する。

## 結果

### メリット
- テストやプロトタイピングでメモリ実装を活用できる。
- 永続化実装を差し替えやすく、責務が分離される。

### トレードオフ
- 2 実装の整合性維持が必要。
- 追加の抽象化による実装コストが増える。
